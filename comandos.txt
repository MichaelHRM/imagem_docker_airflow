from airflow.models import DAG
from airflow.operators.python_operator import PythonOperator
from airflow.hooks.neo4j_hook import Neo4jHook

def extract_data_from_xml():
    tree = ET.parse('/path/to/xml/file')
    root = tree.getroot()
    # Extrair os dados do arquivo XML e armazenar em uma estrutura de dados

def load_data_to_neo4j():
    neo4j_conn = Neo4jHook(neo4j_conn_id='<neo4j_connection_id>')
    # Gravar os dados no banco de dados Neo4j

dag = DAG('xml_to_neo4j', description='Pipeline para ler arquivo XML e gravar no Neo4j', schedule_interval=None)

extract_task = PythonOperator(task_id='extract_data',
                              python_callable=extract_data_from_xml,
                              dag=dag)

load_task = PythonOperator(task_id='load_data',
                           python_callable=load_data_to_neo4j,
                           dag=dag)

extract_task >> load_task





1 docker compose up airflow-init
2 docker compose up
3 The webserver is available at: http://localhost:8080. The default account has the login airflow and the password airflow.
4 remover volumes docker compose down --volumes --rmi all